<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="sqleditor.Views.MainEditor"
             BackgroundColor="{StaticResource TailwindNeutral900}"
             xmlns:mi="http://www.aathifmahir.com/dotnet/2022/maui/icons">
    
    <!-- This would've been done quicker with Tauri/Electron and ReactJS -->
 
    <Grid Padding="30"
          ColumnDefinitions="1*, 2*"
          RowDefinitions="0.5*, 1.5*, 2*">
        <Frame Grid.Column="0"
       Grid.RowSpan="3"
       CornerRadius="10"
       BackgroundColor="{StaticResource TailwindNeutral800}"
       HasShadow="False"
       Padding="20"
       Margin="0,0,15,0">
            <Grid RowDefinitions="Auto,Auto,Auto,*">
                <!-- Header -->
                <VerticalStackLayout Grid.Row="0" Spacing="4" Margin="0,0,0,20">
                    <Label Text="Explorer"
                   TextColor="{StaticResource TailwindNeutral100}"
                   FontSize="24"
                   FontAttributes="Bold"/>
                    <Label Text="Tables"
                   TextColor="{StaticResource TailwindNeutral400}"
                   FontSize="14"/>
                </VerticalStackLayout>

                <!-- Buttons -->
                <HorizontalStackLayout Grid.Row="1" Spacing="8" Margin="0,0,0,16">
                    <ImageButton
                    Source="{mi:Material Icon=ArrowBack, IconSize=24}"
                    BackgroundColor="{StaticResource TailwindNeutral700}"
                    WidthRequest="40"
                    HeightRequest="40"
                    Clicked="OnLogout"
                    CornerRadius="8" />


                    <ImageButton
                    Source="{mi:Material Icon=Terminal, IconSize=24}"
                    BackgroundColor="{StaticResource TailwindNeutral700}"
                    WidthRequest="40"
                    HeightRequest="40"
                    CornerRadius="8" />
                    <ImageButton
                    Source="{mi:Material Icon=Download, IconSize=24}"
                    BackgroundColor="{StaticResource TailwindNeutral700}"
                    WidthRequest="40"
                    HeightRequest="40"
                    CornerRadius="8" />
                    <ImageButton
                    Source="{mi:Material Icon=Add, IconSize=24}"
                    BackgroundColor="{StaticResource TailwindNeutral700}"
                    WidthRequest="40"
                    Clicked="OnAddTableClicked"
                    HeightRequest="40"
                    CornerRadius="8" />
                    <ImageButton
                    Source="{mi:Material Icon=Refresh, IconSize=24}"
                    BackgroundColor="{StaticResource TailwindNeutral700}"
                    WidthRequest="40"
                    HeightRequest="40"
                    Clicked="RefreshPressed"
                    CornerRadius="8" />
                </HorizontalStackLayout>

                <!-- Separator -->
                <BoxView Grid.Row="2" 
                 HeightRequest="1"
                 Color="{StaticResource TailwindNeutral700}"
                 Margin="0,0,0,16"/>

                <!-- Tables List -->
                <ListView Grid.Row="3"
                  x:Name="TablesListView"
                  ItemsSource="{Binding TableNames}"
                  SelectionMode="Single"
                  ItemSelected="OnTableSelected"
                  BackgroundColor="Transparent">
                    <ListView.ItemTemplate>
                        <DataTemplate>
                            <ViewCell>
                                <Label Text="{Binding}"
                               TextColor="{StaticResource TailwindNeutral300}"
                               Padding="8"
                               FontSize="14"/>
                            </ViewCell>
                        </DataTemplate>
                    </ListView.ItemTemplate>
                </ListView>
            </Grid>
        </Frame>

        <!-- Top right box -->
        <!-- Top right box -->
        <Frame Grid.Column="1"
       Grid.Row="0"
       CornerRadius="10"
       BackgroundColor="{StaticResource TailwindNeutral800}"
       HasShadow="False"
       Padding="8"
       Margin="15,0,0,15">
            <Grid ColumnDefinitions="Auto,*,Auto,Auto">
                <!-- Table Name -->
                <Label Grid.Column="0"
               Text="{Binding ActiveTableName}"
               FontSize="16"
               TextColor="{StaticResource TailwindNeutral100}"
               VerticalOptions="Center"
               Margin="0,0,16,0"/>

                <!-- Add Button -->
                <ImageButton
                Grid.Column="2"
                BackgroundColor="{StaticResource TailwindNeutral700}"
                Source="{mi:Material Icon=Add, IconSize=24}"
                WidthRequest="36"
                HeightRequest="36"
                CornerRadius="6"
                Margin="0,0,8,0"
               ></ImageButton>

                <!-- Delete Button -->
                <ImageButton Grid.Column="3"
                BackgroundColor="{StaticResource TailwindNeutral700}"
                Source="{mi:Material Icon=Delete, IconSize=24}"
                WidthRequest="36"
                HeightRequest="36"
                CornerRadius="6"
                Clicked="DeleteTable"
               >
                </ImageButton>
            </Grid>
        </Frame>
        <!-- Bottom right box -->
        <Frame Grid.Column="1"
       Grid.Row="1"
       Grid.RowSpan="2"
       CornerRadius="10"
       BackgroundColor="{StaticResource TailwindNeutral800}"
       HasShadow="False"
       Padding="0"
       Margin="15,15,0,0">

            <Grid RowDefinitions="Auto,*">
                <!-- Dynamic Header Row -->
                <ScrollView Grid.Row="0" Orientation="Horizontal">
                    <HorizontalStackLayout x:Name="HeaderStack"
                                 BackgroundColor="{StaticResource TailwindNeutral700}"
                                 Padding="12,8"/>
                </ScrollView>

                <!-- Dynamic Data Rows -->
                <ScrollView Grid.Row="1">
                    <CollectionView x:Name="DataCollection"
                          ItemsSource="{Binding TableData}">
                        <CollectionView.ItemTemplate>
                            <DataTemplate>
                                <ScrollView Orientation="Horizontal">
                                    <HorizontalStackLayout x:Name="DataStack" 
                                                 Padding="12,8"/>
                                </ScrollView>
                            </DataTemplate>
                        </CollectionView.ItemTemplate>
                    </CollectionView>
                </ScrollView>
            </Grid>
        </Frame>
    </Grid>
</ContentPage>
